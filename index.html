<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OBJ Viewer with Full Controls</title>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
    .controls, .lights, .sliders, .reset, .vertical {
      position: absolute; z-index: 1000;
    }
    .controls {
      bottom: 20px; left: 20px;
      display: grid; grid-template-columns: repeat(3, 50px);
      grid-template-rows: repeat(3, 50px); gap: 5px;
    }
    .vertical {
      bottom: 20px; left: 190px;
      display: flex; flex-direction: column; gap: 5px;
    }
    .lights {
      top: 20px; right: 20px;
      display: flex; flex-direction: column; gap: 10px;
    }
    .sliders {
      bottom: 20px; right: 20px;
      display: flex; flex-direction: column; gap: 5px;
      background: rgba(255, 255, 255, 0.8); padding: 10px;
      border-radius: 10px;
    }
    .reset { top: 20px; left: 20px; }
    button {
      background-color: #333; color: white;
      border: none; border-radius: 5px;
      font-size: 18px; cursor: pointer; opacity: 0.85;
    }
    button:hover { opacity: 1; }
    input[type="range"] { width: 100px; }
  </style>
</head>
<body>

<!-- Reset Button -->
<div class="reset">
  <button onclick="resetPosition()">Reset View</button>
</div>

<!-- Movement Controls -->
<div class="controls">
  <button onclick="move('forward-left')">↖</button>
  <button onclick="move('forward')">↑</button>
  <button onclick="move('forward-right')">↗</button>
  <button onclick="move('left')">←</button>
  <button onclick="jump()">⤒</button>
  <button onclick="move('right')">→</button>
  <button onclick="move('backward-left')">↙</button>
  <button onclick="move('backward')">↓</button>
  <button onclick="move('backward-right')">↘</button>
</div>

<!-- Vertical Camera Buttons -->
<div class="vertical">
  <button onclick="moveVertical('up')">↑ Up</button>
  <button onclick="moveVertical('down')">↓ Down</button>
</div>

<!-- Light Toggles -->
<div class="lights">
  <button onclick="toggleLight('ambient')">Ambient</button>
  <button onclick="toggleLight('directional')">Directional</button>
  <button onclick="toggleLight('point')">Point</button>
</div>

<!-- Light Sliders -->
<div class="sliders">
  <label>Ambient:</label>
  <input type="range" min="0" max="2" step="0.1" value="1" oninput="setLightIntensity('ambient', this.value)">
  <label>Directional:</label>
  <input type="range" min="0" max="5" step="0.1" value="3" oninput="setLightIntensity('directional', this.value)">
  <label>Point:</label>
  <input type="range" min="0" max="5" step="0.1" value="3" oninput="setLightIntensity('point', this.value)">
</div>

<!-- A-Frame Scene -->
<a-scene physics="gravity: -9.8" embedded>
  <a-assets>
    <a-asset-item id="my-obj" src="test.obj"></a-asset-item>
    <a-asset-item id="my-mtl" src="test.mtl"></a-asset-item>
  </a-assets>

  <!-- Lights -->
  <a-light id="ambientLight" type="ambient" color="#ffffff" intensity="1"></a-light>
  <a-light id="directionalLight" type="directional" color="#ffffff" intensity="3" position="2 4 3"></a-light>
  <a-light id="pointLight" type="point" color="#ffffff" intensity="3" distance="10" position="0 3 3"></a-light>

  <!-- Camera Rig -->
  <a-entity id="rig" position="0 1.6 3" dynamic-body="mass: 1; shape: box;">
    <a-camera look-controls="touchEnabled: true" wasd-controls-enabled="false"></a-camera>
  </a-entity>

  <!-- 3x Scaled OBJ Model -->
  <a-entity id="model"
    obj-model="obj: #my-obj; mtl: #my-mtl"
    position="0 0 -3"
    scale="3 3 3"
    static-body>
  </a-entity>

  <!-- Ground -->
  <a-plane rotation="-90 0 0" width="10" height="10" color="#8B4513" static-body></a-plane>
</a-scene>

<!-- JavaScript -->
<script>
  function move(direction) {
    const rig = document.querySelector('#rig');
    const pos = rig.getAttribute('position');
    const step = 0.3;
    const directions = {
      forward: [0, 0, -step], backward: [0, 0, step],
      left: [-step, 0, 0], right: [step, 0, 0],
      'forward-left': [-step, 0, -step],
      'forward-right': [step, 0, -step],
      'backward-left': [-step, 0, step],
      'backward-right': [step, 0, step]
    };
    const [dx, dy, dz] = directions[direction];
    rig.setAttribute('position', {x: pos.x + dx, y: pos.y + dy, z: pos.z + dz});
  }

  function moveVertical(direction) {
    const rig = document.querySelector('#rig');
    const pos = rig.getAttribute('position');
    const delta = direction === 'up' ? 0.3 : -0.3;
    rig.setAttribute('position', {x: pos.x, y: pos.y + delta, z: pos.z});
  }

  function jump() {
    const rig = document.querySelector('#rig');
    const el = rig.body ? rig.body : rig.components['dynamic-body'].body;
    if (el && el.velocity.y < 0.05) {
      el.applyImpulse({x: 0, y: 3, z: 0}, el.position);
    }
  }

  function toggleLight(type) {
    const light = document.getElementById(type + 'Light');
    light.setAttribute('visible', !light.getAttribute('visible'));
  }

  function setLightIntensity(type, val) {
    const light = document.getElementById(type + 'Light');
    light.setAttribute('intensity', parseFloat(val));
  }

  function resetPosition() {
    const rig = document.querySelector('#rig');
    rig.setAttribute('position', {x: 0, y: 1.6, z: 3});
    if (rig.body) rig.body.velocity.set(0, 0, 0);
  }
</script>

</body>
</html>
